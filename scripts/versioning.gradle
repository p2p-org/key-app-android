ext.VERSION_NAME = VERSION_MAJOR + "." + VERSION_MINOR + "." + VERSION_HOTFIX

ext.VERSION_CODE = 1_000_00 * (VERSION_MAJOR as Integer) +
        1_000 * (VERSION_MINOR as Integer) +
        1_0 * (VERSION_HOTFIX as Integer) +
        VERSION_PATCH as Integer

// example './gradlew setVersionBuild -Pversion=10'
task setVersionBuild(group: 'versioning', description: 'Sets build version') {
    doLast {
        ant.propertyfile(file: 'gradle.properties') {
            int buildNumber = VERSION_BUILD as Integer + version.toInteger()
            entry(key: 'VERSION_BUILD', value: buildNumber)
        }
    }
}

ext.generateAppName = { ->
    "key-app-${VERSION_NAME}.${getVersionBuild()}"
}

ext.getVersionBuild = { ->
    def buildNumberFromCi = System.getenv("CIRCLE_BUILD_NUM")

    if (buildNumberFromCi != null) {
        return buildNumberFromCi.toInteger()
    } else {
        return VERSION_BUILD
    }
}