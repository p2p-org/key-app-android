name: "Jira manipulations - READY FOR TESTING"
description: "When a feature build is uploaded to Firebase&Slack, moving the ticket number to RFT status in JIRA"
inputs:
  jira-base-url:
    description: "Jira base url"
    required: true
  jira-user-email:
    description: "Jira user email"
    required: true
    default: "chyngyz.i@p2p.org"
  jira-api-token:
    description: "Jira api token related to the jira-user-email"
    required: true

runs:
  using: composite
  steps:
    - name: "Login"
      uses: atlassian/gajira-login@v3
      env:
        JIRA_BASE_URL: ${{ inputs.jira-base-url }}
        JIRA_USER_EMAIL: ${{ inputs.jira-user-email }}
        JIRA_API_TOKEN: ${{ inputs.jira-api-token }}

    - name: "Find ticket number in from commits"
      id: rft
      uses: atlassian/gajira-find-issue-key@v3
      with:
        from: commits

    - name: "Jira Ticket Transition"
      uses: atlassian/gajira-transition@v3
      with:
        issue: ${{ steps.rft.outputs.issue }}
        transition: "QA"